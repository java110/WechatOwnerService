(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/applicationKeyUser/applicationKeyUser"],{"0f7f":function(e,t,n){"use strict";var o=n("1bed"),i=n.n(o);i.a},1250:function(e,t,n){"use strict";(function(e){n("a8a6"),n("921b");o(n("66fd"));var t=o(n("364c"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"19b9":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("567f"),i=o.util,a=o.factory,s=o.constant,d={data:function(){return{index:-1,indexIdent:-1,indexExpiry:-1,locations:[],communityId:"",showTypeCd:!1,typeCdList:["业主","家庭成员","租客"],typeCdName:"业主",sexList:["男","女"],showSex:!1,showExpiry:!1,expiryList:["一个月","半年","一年"],photoList:[],name:"",age:null,sex:"男",typeCd:"10004",idCard:"",startTime:null,endTime:null,tel:"",photos:[],msgCode:"",imgList:[],expiry:"",second:60,btnValue:"验证码",btnDisabled:!1,propertyId:""}},components:{},props:{},onLoad:function(e){var t=this;o.getOwner((function(e){t.name=e.appUserName,t.idCard=e.idCard,t.tel=e.link})),this.locations=JSON.parse(e.locations),this.communityId=e.communityId,o.getProperty().then((function(e){t.propertyId=e.storeId}))},onReady:function(){},onShow:function(){var e=i.date.formatTime(new Date);this.startTime=e},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{PickerChange:function(e){this.index=e.detail.value,console.log("选择性别",e),this.showSex=!1,this.sex=e.detail.value},PickerIdentChange:function(e){this.indexIdent=e.detail.value},PickerExpiryChange:function(e){this.indexExpiry=e.detail.value;var t=null;t="一个月"==e.detail.value?i.date.formatTime(i.date.addMonth(new Date,1)):"半年"==e.detail.value?i.date.formatTime(i.date.addMonth(new Date,6)):i.date.formatTime(i.date.addYear(new Date,1)),this.showExpiry=!1,this.expiry=e.detail.value,this.endTime=t},ViewImage:function(t){e.previewImage({urls:this.imgList,current:t.currentTarget.dataset.url})},removePhoto:function(e){var t=[];this.imgList.forEach((function(n,o){o!=e&&t.push(n)}));var n=[];this.photos.forEach((function(t,o){o!=e&&n.push(t)})),this.photos=n,this.imgList=t},deleteImage:function(e){console.log(e);var t=this.$data.imgList;t.splice(e,1)},ChooseImage:function(e){var t=this;wx.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(e){console.log(e),t.$data.imgList.push(e.tempFilePaths[0]);var n="";a.base64.urlTobase64(e.tempFilePaths[0]).then((function(e){n=e,console.log("base64",n),t.photos.push(n)}))}})},sendMsgCode:function(){console.log("获取验证码");var t=this,n={tel:this.tel};console.log("obj",n),""!=n.tel?e.request({url:s.url.userSendSms,header:o.getHeaders(),method:"POST",data:n,success:function(e){if(console.log(e),200==e.statusCode)return wx.showToast({title:"验证码下发成功",icon:"none",duration:2e3}),wx.hideLoading(),void t.timer();wx.hideLoading(),wx.showToast({title:e.data,icon:"none",duration:2e3})},fail:function(e){wx.hideLoading(),wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}}):wx.showToast({title:"请输入手机号",icon:"none",duration:2e3})},timer:function(){var e=this,t=new Promise((function(t,n){var o=setInterval((function(){var n=e.second-1;e.second=n,e.btnValue=n+"秒",e.btnDisabled=!0,e.second<=0&&(e.second=60,e.btnValue="获取验证码",e.btnDisabled=!1,t(o))}),1e3)}));t.then((function(e){clearInterval(e)}))},chooseTypeCd:function(){this.showTypeCd=!0},onConfirm:function(e){console.log("onConfirm",e);var t="";t=0==e.detail.index?"10004":1==e.detail.index?"10005":"10006",this.showTypeCd=!1,this.typeCd=t,this.typeCdName=e.detail.value},onChange:function(e){console.log(e)},onCancel:function(e){this.showTypeCd=!1},chooseSex:function(){this.showSex=!0},onSexConfirm:function(e){console.log("onConfirm",e),this.showSex=!1,this.sex=e.detail.value},onSexChange:function(e){console.log(e)},onSexCancel:function(e){this.showSex=!1},chooseExpiry:function(){this.showExpiry=!0},onExpiryConfirm:function(e){console.log("onConfirm",e);var t=null;t="一个月"==e.detail.value?i.date.formatTime(i.date.addMonth(new Date,1)):"半年"==e.detail.value?i.date.formatTime(i.date.addMonth(new Date,6)):i.date.formatTime(i.date.addYear(new Date,1)),this.showExpiry=!1,this.expiry=e.detail.value,this.endTime=t},onExpiryChange:function(e){console.log(e)},onExpiryCancel:function(e){this.showExpiry=!1},saveApplicationKey:function(){var e={name:this.name,age:this.age,sex:this.sex,typeCd:this.typeCd,idCard:this.idCard,startTime:this.startTime,endTime:this.endTime,tel:this.tel,photos:[],msgCode:this.msgCode,communityId:this.communityId,machineIds:[],typeFlag:"1100102",storeId:this.propertyId};console.log(e);var t=this.photos;t.forEach((function(t){e.photos.push({photo:t})}));var n="";""==e.name&&(n="请填写名称"),null==e.age&&(n="请填写年龄"),0!=e.sex&&1!=e.sex&&(n="请选择性别"),""==e.typeCd&&(n="请选择身份"),""==e.idCard&&(n="请填写身份证"),null==e.startTime&&(n="请选择有效期"),null==e.endTime&&(n="请选择有效期"),""==e.tel&&(n="请选择填写手机号"),(null==e.photos||e.photos.length<2)&&(n="请选择证件照片"),""==e.msgCode&&(n="请填写验证码"),(null==this.locations||this.locations.length<1)&&(n="没有设备可申请钥匙"),""==n?(this.locations.forEach((function(t){e.machineIds.push({machineId:t.machineId})})),console.log(e),o.request({url:s.url.applyApplicationKey,header:o.getHeaders(),method:"POST",data:e,success:function(e){console.log("请求返回信息：",e),200!=e.statusCode?wx.showToast({title:"服务器异常了",icon:"none",duration:2e3}):wx.redirectTo({url:"/pages/applicationKeyProgress/applicationKeyProgress"})},fail:function(e){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}})):wx.showToast({title:n,icon:"none",duration:2e3})}}};t.default=d}).call(this,n("543d")["default"])},"1bed":function(e,t,n){},"1e28":function(e,t,n){"use strict";n.r(t);var o=n("19b9"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},"364c":function(e,t,n){"use strict";n.r(t);var o=n("d6aa"),i=n("1e28");for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("0f7f");var s,d=n("f0c5"),r=Object(d["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);t["default"]=r.exports},d6aa:function(e,t,n){"use strict";var o,i=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))}},[["1250","common/runtime","common/vendor"]]]);