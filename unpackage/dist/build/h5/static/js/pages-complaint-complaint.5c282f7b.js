(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-complaint-complaint"],{"594d":function(t,o,i){"use strict";i("4160"),i("d81d"),i("a434"),i("159b"),Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=i("675c"),e=n.constant,a=n.factory,s={data:function(){return{imgList:[],imageIndex:0,index:null,complaintIndex:0,roomCloums:[],roomIdArr:[],roomName:"请选择",roomId:"",roomShow:!1,columns:["投诉","建议"],typeCds:["809001","809002"],typeName:"请选择",typeCd:"",typeShow:!1,photoList:[],tel:"",context:"",complaintName:"",userId:"",storeId:"",photos:[],communityId:""}},onLoad:function(t){var o=this;n.onLoad(t),n.getRooms().then((function(t){console.log(t);var i=t.data.rooms,n=[],e=[];i.map((function(t){n.push(t.floorNum+"号楼"+t.unitNum+"单元"+t.roomNum+"室"),e.push(t.roomId)})),console.log(o),o.roomCloums=n,o.roomIdArr=e,o.userId=t.data.owner.appUserId,o.communityId=t.data.owner.communityId}))},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{ChooseImage:function(t){var o=this;wx.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(t){console.log(t),o.$data.imgList.push(t.tempFilePaths[0]);var i="";a.base64.urlTobase64(t.tempFilePaths[0]).then((function(t){i=t,console.log("base64",i),o.photos.push(i)}))}})},deleteImage:function(t){console.log(t);var o=this.$data.imgList;o.splice(t,1)},_changeComplaint:function(t){this.typeName=this.columns[t.detail.value],this.typeCd=this.typeCds[t.detail.value]},_changeRoom:function(t){this.roomName=this.roomCloums[t.detail.value],this.roomId=this.roomIdArr[t.detail.value]},bindInput:function(t){switch(console.log("数据监听",t),t.target.id){case"complaintName":this.$data.complaintName=t.detail.value;break;case"tel":this.$data.tel=t.detail.value;break;case"context":this.$data.context=t.detail.value;break}console.log(this)},bindOwner:function(t){var o={typeCd:this.typeCd,complaintName:this.complaintName,tel:this.tel,roomId:this.roomId,photos:[],context:this.context,userId:this.userId,communityId:this.communityId},i=this.photos;i.forEach((function(t){o.photos.push({photo:t})}));var a="";""==o.typeCd?a="请选择投诉类型":""==o.complaintName?a="请填写投诉人":""==o.tel?a="请填写手机号":""==o.context&&(a="请填写投诉内容"),""!=a?wx.showToast({title:a,icon:"none",duration:2e3}):(console.log("提交数据",o),n.request({url:e.url.saveComplaint,header:n.getHeaders(),method:"POST",data:o,success:function(t){200!=t.statusCode?wx.showToast({title:"服务器异常了",icon:"none",duration:2e3}):wx.redirectTo({url:"/pages/complaintList/complaintList"})},fail:function(t){console.log(t),wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}}))},onChange:function(t){console.log(t)},onTypeConfirm:function(t){console.log("onConfirm",t),this.typeName=t.detail.value,this.typeCd=t.detail.index?"809001":"809002",this.typeShow=!1},onTypeCancel:function(t){this.typeShow=!1},chooseType:function(t){this.typeShow=!0},onRoomConfirm:function(t){console.log("onConfirm",t),this.roomName=t.detail.value,this.roomId=this.roomIdArr[t.detail.index],this.roomShow=!1},onRoomCancel:function(t){this.roomShow=!1},chooseRoom:function(t){this.roomShow=!0},afterRead:function(t){var o=t.detail.file,i=this,n=this.photoList,e=void 0===n?[]:n;e.push(o),this.photoList=e,a.base64.urlTobase64(o.path).then((function(t){i.photos.push(t)})),console.log("data信息：",this)},removePhoto:function(t){console.log(t.detail.index);var o=[];this.photoList.forEach((function(i,n){n!=t.detail.index&&o.push(i)}));var i=[];this.photos.forEach((function(o,n){n!=t.detail.index&&i.push(o)})),this.photos=i,this.photoList=o}}};o.default=s},"61ff":function(t,o,i){"use strict";var n,e=function(){var t=this,o=t.$createElement,i=t._self._c||o;return i("v-uni-view",[i("v-uni-view",{staticClass:"block__title"},[t._v("房屋信息")]),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("房屋信息")]),i("v-uni-picker",{attrs:{value:t.index,range:t.roomCloums},on:{change:function(o){arguments[0]=o=t.$handleEvent(o),t._changeRoom.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[t._v(t._s(t.roomName))])],1)],1),i("v-uni-view",{staticClass:"block__title"},[t._v("投诉信息")]),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("投诉类型")]),i("v-uni-picker",{attrs:{value:t.complaintIndex,range:t.columns},on:{change:function(o){arguments[0]=o=t.$handleEvent(o),t._changeComplaint.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[t._v(t._s(t.typeName))])],1)],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("投诉人")]),i("v-uni-input",{attrs:{id:"complaintName",value:t.complaintName,placeholder:"请输入投诉人"},on:{input:function(o){arguments[0]=o=t.$handleEvent(o),t.bindInput.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("手机号")]),i("v-uni-input",{attrs:{id:"tel",value:t.tel,placeholder:"请输入手机号"},on:{input:function(o){arguments[0]=o=t.$handleEvent(o),t.bindInput.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-textarea",{attrs:{id:"context",value:t.context,placeholder:"请输入投诉内容"},on:{input:function(o){arguments[0]=o=t.$handleEvent(o),t.bindInput.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"cu-bar bg-white margin-top"},[i("v-uni-view",{staticClass:"action"},[t._v("图片上传")]),i("v-uni-view",{staticClass:"action"},[t._v(t._s(t.imgList.length)+"/4")])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[t._l(t.imgList,(function(o,n){return i("v-uni-view",{key:n,staticClass:"bg-img",attrs:{bindtap:"ViewImage","data-url":t.imgList[t.imageIndex]}},[i("v-uni-image",{attrs:{src:t.imgList[n],mode:"aspectFill"}}),i("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":t.imageIndex},on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.deleteImage(n)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),t.imgList.length<4?i("v-uni-view",{staticClass:"solids",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.ChooseImage.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):t._e()],2)],1),i("v-uni-view",{staticClass:"button_up_blank"}),i("v-uni-view",{staticClass:"flex flex-direction"},[i("v-uni-button",{staticClass:"cu-btn bg-green margin-tb-sm lg",on:{click:function(o){arguments[0]=o=t.$handleEvent(o),t.bindOwner()}}},[t._v("提交")])],1)],1)},a=[];i.d(o,"b",(function(){return e})),i.d(o,"c",(function(){return a})),i.d(o,"a",(function(){return n}))},"647e":function(t,o,i){"use strict";i.r(o);var n=i("594d"),e=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(o,t,(function(){return n[t]}))}(a);o["default"]=e.a},"7d55":function(t,o,i){var n=i("24fb");o=n(!1),o.push([t.i,".block__title[data-v-98a91138]{margin:0;font-weight:400;font-size:14px;color:rgba(69,90,100,.6);padding:%?40?% %?30?% %?20?%}.button_up_blank[data-v-98a91138]{height:%?40?%}.uploader-container[data-v-98a91138]{margin:0 10px}.aku_photo_view[data-v-98a91138]{background-color:#fff;padding:%?40?% 0 %?40?% %?40?%}.aku_photo_view uni-text[data-v-98a91138]{font-size:%?30?%;color:#8a8a8a}",""]),t.exports=o},9379:function(t,o,i){"use strict";var n=i("dccb"),e=i.n(n);e.a},af37:function(t,o,i){"use strict";i.r(o);var n=i("61ff"),e=i("647e");for(var a in e)"default"!==a&&function(t){i.d(o,t,(function(){return e[t]}))}(a);i("9379");var s,c=i("f0c5"),u=Object(c["a"])(e["default"],n["b"],n["c"],!1,null,"98a91138",null,!1,n["a"],s);o["default"]=u.exports},dccb:function(t,o,i){var n=i("7d55");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var e=i("4f06").default;e("106bee6e",n,!0,{sourceMap:!1,shadowMode:!1})}}]);